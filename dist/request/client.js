"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.clientInstance=exports.default=void 0,require("core-js/modules/es.array.concat"),require("core-js/modules/es.promise"),require("core-js/modules/es.object.to-string"),require("core-js/modules/es.function.bind");var _regeneratorRuntime=_interopRequireDefault(require("regenerator-runtime")),_myzod=require("myzod"),_types=require("../types"),_failedToGetCredential=_interopRequireDefault(require("../types/error/failed_to_get_credential")),_apiError=_interopRequireDefault(require("../types/error/api_error"));function asyncGeneratorStep(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(j){c(j);return}h.done?b(i):Promise.resolve(i).then(d,e)}function _asyncToGenerator(k){return function(){var l=this,m=arguments;return new Promise(function(b,c){var a=k.apply(l,m);function d(i){asyncGeneratorStep(a,b,c,d,e,"next",i)}function e(n){asyncGeneratorStep(a,b,c,d,e,"throw",n)}d(void 0)})}}function _classCallCheck(o,p){if(!(o instanceof p))throw new TypeError("Cannot call a class as a function")}function _defineProperties(q,r){for(var s=0;s<r.length;s++){var t=r[s];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(q,t.key,t)}}function _createClass(p,u,v){return u&&_defineProperties(p.prototype,u),v&&_defineProperties(p,v),p}function _defineProperty(w,f,i){return f in w?Object.defineProperty(w,f,{value:i,enumerable:!0,configurable:!0,writable:!0}):w[f]=i,w}function _interopRequireDefault(w){return w&&w.__esModule?w:{default:w}}function _objectSpread(q){for(var s=1;s<arguments.length;s++){var x=null!=arguments[s]?arguments[s]:{},y=Object.keys(x);"function"==typeof Object.getOwnPropertySymbols&&(y=y.concat(Object.getOwnPropertySymbols(x).filter(function(z){return Object.getOwnPropertyDescriptor(x,z).enumerable}))),y.forEach(function(f){_defineProperty(q,f,x[f])})}return q}function _objectWithoutProperties(x,A){if(null==x)return{};var f,s,q=_objectWithoutPropertiesLoose(x,A);if(Object.getOwnPropertySymbols){var B=Object.getOwnPropertySymbols(x);for(s=0;s<B.length;s++)f=B[s],A.indexOf(f)>=0||Object.prototype.propertyIsEnumerable.call(x,f)&&(q[f]=x[f])}return q}function _objectWithoutPropertiesLoose(x,A){if(null==x)return{};var f,s,q={},C=Object.keys(x);for(s=0;s<C.length;s++)f=C[s],A.indexOf(f)>=0||(q[f]=x[f]);return q}var Client=function(){"use strict";function Client(){_classCallCheck(this,Client),this.backendURI="https://api.csc.deershark.com/api"}return _createClass(Client,[{key:"BackendURI",get:function(){return this.backendURI},set:function(D){this.backendURI=D}},{key:"baseFetcher",value:function(E,F){var G=void 0===F?{headers:{}}:F,H=G.headers,I=_objectWithoutProperties(G,["headers"]),J="".concat(this.BackendURI).concat(E);return fetch(J,_objectSpread({},I,{headers:_objectSpread({},H,{"User-Agent":"cscheckin-sdk-std/2.0"})}))}},{key:"jsonFetcher",value:function(K,L){return _asyncToGenerator(_regeneratorRuntime.default.mark(function _callee(){var M;return _regeneratorRuntime.default.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.next=2,this.baseFetcher(K,L);case 2:return M=N.sent,N.next=5,M.json();case 5:return N.abrupt("return",{data:N.sent,statusCode:M.status});case 6:case"end":return N.stop()}},_callee,this)}).bind(this))()}},{key:"textFetcher",value:function(O,P){return _asyncToGenerator(_regeneratorRuntime.default.mark(function _callee(){var Q;return _regeneratorRuntime.default.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.next=2,this.baseFetcher(O,P);case 2:return Q=R.sent,R.next=5,Q.text();case 5:return R.abrupt("return",{data:R.sent,statusCode:Q.status});case 6:case"end":return R.stop()}},_callee,this)}).bind(this))()}}],[{key:"getInstance",value:function(){return Client.instance||(Client.instance=new Client()),Client.instance}},{key:"authRequest",value:function(S,T){var U=void 0===T?{headers:{}}:T;return _asyncToGenerator(_regeneratorRuntime.default.mark(function _callee(){var V,W,X;return _regeneratorRuntime.default.wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:return V=U.headers,W=_objectWithoutProperties(U,["headers"]),Y.next=3,S.getAuthenticationHeader();case 3:if(X=Y.sent){Y.next=6;break}throw new _failedToGetCredential.default();case 6:return Y.abrupt("return",_objectSpread({},W,{headers:_objectSpread({},V,{Authorization:X})}));case 7:case"end":return Y.stop()}},_callee)}))()}},{key:"postJsonRequest",value:function(Z,$){var _=void 0===$?{headers:{}}:$,aa=_.headers,ba=_objectWithoutProperties(_,["headers"]);return _objectSpread({},ba,{body:JSON.stringify(Z),method:"POST",headers:_objectSpread({},aa,{"Content-Type":"application/json"})})}},{key:"responseParser",value:function(ca,da){var ea=da.try(ca);if(ea instanceof _myzod.ValidationError){var fa=_types.StandardErrorResponseSchema.try(ca);if(fa instanceof _myzod.ValidationError)throw fa;if(fa.message)throw new _apiError.default(fa.message);if(fa.error)throw new _apiError.default(fa.error);throw ea}return ea}},{key:"isResponseOk",value:function(ga){return ga>=200&&ga<=299}}]),Client}();Client.instance=null,exports.default=Client;var clientInstance=Client.getInstance();exports.clientInstance=clientInstance
//# sourceMappingURL=client.js.map