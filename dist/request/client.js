import"core-js/modules/es.array.concat";import"core-js/modules/es.promise";import"core-js/modules/es.object.to-string";import"core-js/modules/es.function.bind";import a from"regenerator-runtime";import{ValidationError as b}from"myzod";import{StandardErrorResponseSchema as c}from"../types";import d from"../types/error/failed_to_get_credential";import e from"../types/error/api_error";function asyncGeneratorStep(f,g,h,i,j,k,l){try{var m=f[k](l),n=m.value}catch(o){h(o);return}m.done?g(n):Promise.resolve(n).then(i,j)}function _asyncToGenerator(p){return function(){var q=this,r=arguments;return new Promise(function(g,h){var f=p.apply(q,r);function i(n){asyncGeneratorStep(f,g,h,i,j,"next",n)}function j(s){asyncGeneratorStep(f,g,h,i,j,"throw",s)}i(void 0)})}}function _classCallCheck(t,u){if(!(t instanceof u))throw new TypeError("Cannot call a class as a function")}function _defineProperties(v,w){for(var x=0;x<w.length;x++){var y=w[x];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(v,y.key,y)}}function _createClass(u,z,A){return z&&_defineProperties(u.prototype,z),A&&_defineProperties(u,A),u}function _defineProperty(B,k,n){return k in B?Object.defineProperty(B,k,{value:n,enumerable:!0,configurable:!0,writable:!0}):B[k]=n,B}function _objectSpread(v){for(var x=1;x<arguments.length;x++){var C=null!=arguments[x]?arguments[x]:{},D=Object.keys(C);"function"==typeof Object.getOwnPropertySymbols&&(D=D.concat(Object.getOwnPropertySymbols(C).filter(function(E){return Object.getOwnPropertyDescriptor(C,E).enumerable}))),D.forEach(function(k){_defineProperty(v,k,C[k])})}return v}function _objectWithoutProperties(C,F){if(null==C)return{};var k,x,v=_objectWithoutPropertiesLoose(C,F);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(C);for(x=0;x<G.length;x++)k=G[x],F.indexOf(k)>=0||Object.prototype.propertyIsEnumerable.call(C,k)&&(v[k]=C[k])}return v}function _objectWithoutPropertiesLoose(C,F){if(null==C)return{};var k,x,v={},H=Object.keys(C);for(x=0;x<H.length;x++)k=H[x],F.indexOf(k)>=0||(v[k]=C[k]);return v}var Client=function(){"use strict";function Client(){_classCallCheck(this,Client),this.backendURI="https://api.csc.deershark.com/api"}return _createClass(Client,[{key:"BackendURI",get:function(){return this.backendURI},set:function(I){this.backendURI=I}},{key:"baseFetcher",value:function(J,K){var L=void 0===K?{headers:{}}:K,M=L.headers,N=_objectWithoutProperties(L,["headers"]),O="".concat(this.BackendURI).concat(J);return fetch(O,_objectSpread({},N,{headers:_objectSpread({},M,{"User-Agent":"cscheckin-sdk-std/2.0"})}))}},{key:"jsonFetcher",value:function(P,Q){return _asyncToGenerator(a.mark(function _callee(){var R;return a.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,this.baseFetcher(P,Q);case 2:return R=S.sent,S.next=5,R.json();case 5:return S.abrupt("return",{data:S.sent,statusCode:R.status});case 6:case"end":return S.stop()}},_callee,this)}).bind(this))()}},{key:"textFetcher",value:function(T,U){return _asyncToGenerator(a.mark(function _callee(){var V;return a.wrap(function(W){for(;;)switch(W.prev=W.next){case 0:return W.next=2,this.baseFetcher(T,U);case 2:return V=W.sent,W.next=5,V.text();case 5:return W.abrupt("return",{data:W.sent,statusCode:V.status});case 6:case"end":return W.stop()}},_callee,this)}).bind(this))()}}],[{key:"getInstance",value:function(){return Client.instance||(Client.instance=new Client()),Client.instance}},{key:"authRequest",value:function(X,Y){var Z=void 0===Y?{headers:{}}:Y;return _asyncToGenerator(a.mark(function _callee(){var $,_,aa;return a.wrap(function(ba){for(;;)switch(ba.prev=ba.next){case 0:return $=Z.headers,_=_objectWithoutProperties(Z,["headers"]),ba.next=3,X.getAuthenticationHeader();case 3:if(aa=ba.sent){ba.next=6;break}throw new d();case 6:return ba.abrupt("return",_objectSpread({},_,{headers:_objectSpread({},$,{Authorization:aa})}));case 7:case"end":return ba.stop()}},_callee)}))()}},{key:"postJsonRequest",value:function(ca,da){var ea=void 0===da?{headers:{}}:da,fa=ea.headers,ga=_objectWithoutProperties(ea,["headers"]);return _objectSpread({},ga,{body:JSON.stringify(ca),method:"POST",headers:_objectSpread({},fa,{"Content-Type":"application/json"})})}},{key:"responseParser",value:function(ha,ia){var ja=ia.try(ha);if(ja instanceof b){var ka=c.try(ha);if(ka instanceof b)throw ka;if(ka.message)throw new e(ka.message);if(ka.error)throw new e(ka.error);throw ja}return ja}},{key:"isResponseOk",value:function(la){return la>=200&&la<=299}}]),Client}();Client.instance=null;export{Client as default};export var clientInstance=Client.getInstance()
//# sourceMappingURL=client.js.map